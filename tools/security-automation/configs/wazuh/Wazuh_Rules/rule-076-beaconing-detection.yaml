title: Command and Control Beaconing Detection
id: net-076-c2-beaconing
status: stable
description: Detects periodic network connections characteristic of C2 beaconing
author: HawkinsOps SOC
date: 2025-11-18

summary: |
  Identifies regular, periodic network connections to external hosts that may indicate
  command and control (C2) beaconing patterns used by malware and RATs.

detection_logic: |
  Monitor network connections for:
  - Regular intervals between connections (e.g., every 60 seconds, every 5 minutes)
  - Connections to same destination repeatedly
  - Small, consistent payload sizes
  - Persistent connections over extended periods
  - Connections during off-hours

  Statistical analysis:
  - Calculate coefficient of variation for connection intervals
  - Flag connections with CV < 0.3 (highly regular timing)
  - Check for jitter patterns (randomized timing to evade detection)

fields_used:
  - src_ip: Source IP address (compromised host)
  - dst_ip: Destination IP (C2 server)
  - dst_port: Destination port
  - bytes_in: Inbound data size
  - bytes_out: Outbound data size
  - connection_count: Number of connections
  - interval_avg: Average time between connections
  - interval_stddev: Standard deviation of intervals

falsepositives:
  - Legitimate software update checks
  - Network monitoring tools and agents
  - Heartbeat mechanisms in distributed systems
  - Cloud service synchronization
  - Time synchronization (NTP) - should be whitelisted

level: high

mitre_attack:
  tactic: TA0011  # Command and Control
  technique: T1071.001  # Application Layer Protocol

log_source_refs:
  - Network flow data (NetFlow, IPFIX)
  - Firewall connection logs
  - Proxy logs
  - IDS/IPS logs
  - Packet capture data

test_examples:
  - Malware connecting to C2 every 60 seconds Â±2 seconds
  - RAT beaconing every 5 minutes with 512-byte payload
  - Cobalt Strike beacon with jitter (randomized intervals)
  - Persistent connection pattern: 10+ connections over 1 hour with regular timing

tuning_notes: |
  - Whitelist known legitimate beaconing (update services, monitoring agents)
  - Adjust interval regularity threshold based on your environment
  - Correlate with threat intelligence feeds for known C2 IPs
  - Check for encrypted traffic to unusual destinations
  - Monitor for beacon survival after system reboots
  - Implement statistical analysis for interval patterns
  - Alert on beaconing to recently registered domains
  - Track long-duration beacon sessions (days/weeks)
