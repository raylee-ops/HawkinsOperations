title: LSASS Memory Access - Credential Dumping
id: hawkinsops-t1003-001
status: production
description: |
  Detects attempts to access LSASS memory, commonly used for credential dumping.
  High-confidence indicator of credential theft attempts.
references:
  - https://attack.mitre.org/techniques/T1003/001/
  - https://www.microsoft.com/security/blog/credential-dumping-lsass
author: HawkinsOps
date: 2026/01/15
modified: 2026/01/20
tags:
  - attack.credential_access
  - attack.t1003.001
logsource:
  category: process_access
  product: windows
detection:
  selection:
    TargetImage|endswith: '\lsass.exe'
    GrantedAccess|contains:
      - '0x1010'    # PROCESS_QUERY_LIMITED_INFORMATION + PROCESS_VM_READ
      - '0x1410'    # Above + PROCESS_QUERY_INFORMATION
      - '0x1438'    # Above + additional
      - '0x143a'    # Full access pattern
      - '0x1fffff'  # PROCESS_ALL_ACCESS
  filter_legitimate:
    SourceImage|endswith:
      - '\wmiprvse.exe'
      - '\taskmgr.exe'
      - '\procexp64.exe'
      - '\procexp.exe'
      - '\MsMpEng.exe'        # Windows Defender
      - '\csrss.exe'
      - '\wininit.exe'
      - '\services.exe'
  condition: selection and not filter_legitimate
falsepositives:
  - Legitimate security tools performing memory analysis
  - EDR/AV products scanning for threats
  - System administration tools
level: high
# =============================================================================
# HawkinsOps Detection Documentation Standard (DDS)
# =============================================================================
# 
# TEST CASE:
#   Tool: Mimikatz
#   Command: sekurlsa::logonpasswords
#   Expected: Alert fires within 30 seconds
#   Tested: 2026-01-15 on HO-WE-01
#
# FALSE POSITIVE RATE:
#   Lab environment: <2%
#   Production estimate: 5-10% (tune filter_legitimate for your environment)
#
# TUNING NOTES:
#   - Add legitimate security tools to filter_legitimate
#   - Consider adding SourceUser filter for known admin accounts
#   - May need to whitelist specific monitoring software
#
# EVIDENCE:
#   - Test screenshot: /PROOF_PACK/SCREENSHOTS/T1003-001-test.png
#   - Alert JSON: /PROOF_PACK/SAMPLES/T1003-001-alert.json
# =============================================================================
