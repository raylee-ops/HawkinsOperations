<!--
  Wazuh Rule: Multiple Authentication Failures
  ID: 100051
  Level: 10 (High)
  Description: Detects multiple authentication failures indicating brute force attempts
  Author: HawkinsOps SOC
  Date: 2025-11-18
-->

<group name="authentication,">
  <rule id="100051" level="10" frequency="5" timeframe="300">
    <if_matched_sid>5503,5710</if_matched_sid>
    <description>Multiple authentication failures detected - Possible brute force attack</description>
    <mitre>
      <id>T1110.001</id>
    </mitre>
    <group>authentication_failures,brute_force,</group>
  </rule>
</group>

<!--
Summary:
  Triggers when 5 or more authentication failures occur within 5 minutes from the same source.
  Detects brute force login attempts against Windows (5503) and SSH (5710) services.

Fields Used:
  - srcip: Source IP address of authentication attempts
  - user: Target username
  - timestamp: Event occurrence time

False Positives:
  - Users with forgotten passwords
  - Misconfigured automation scripts
  - Legitimate password expiration scenarios

Severity: High (10)

MITRE ATT&CK: T1110.001 - Brute Force: Password Guessing

Log Sources:
  - Windows Security Event 4625 (Failed logon)
  - Linux /var/log/auth.log (SSH failures)
  - Wazuh agent logs from endpoints

Test Examples:
  - 5 failed SSH attempts within 5 minutes
  - Multiple Windows login failures from same IP
  - Repeated authentication failures against web services

Tuning Notes:
  - Adjust frequency threshold based on your environment
  - Whitelist known scanning/monitoring tools by IP
  - Consider creating separate rules for different services
  - Correlate with successful login following failures
  - Implement IP-based blocking for repeated offenders
-->
