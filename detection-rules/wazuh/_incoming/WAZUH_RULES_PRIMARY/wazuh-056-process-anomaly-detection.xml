<!--
  Wazuh Rule: Anomalous Process Execution Detected
  ID: 100056
  Level: 9 (Medium-High)
  Description: Unusual process execution pattern detected by anomaly detection
  Author: HawkinsOps SOC
  Date: 2025-11-18
-->

<group name="process,anomaly,">
  <rule id="100056" level="9">
    <if_sid>530</if_sid>
    <match>process</match>
    <field name="anomaly_score">^[8-9]|^10$</field>
    <description>Anomalous process detected - Unusual execution pattern</description>
    <mitre>
      <id>T1059</id>
    </mitre>
    <group>anomaly_detection,process_anomaly,</group>
  </rule>
</group>

<!--
Summary:
  Leverages Wazuh's anomaly detection capabilities to identify processes with
  unusual characteristics compared to historical baselines.

Fields Used:
  - process_name: Name of anomalous process
  - process_path: Full path to executable
  - anomaly_score: Score from 0-10 indicating deviation from baseline
  - parent_process: Parent process information

False Positives:
  - New software installations
  - System updates
  - User behavior changes
  - Seasonal business activities

Severity: Medium-High (9)

MITRE ATT&CK: T1059 - Command and Scripting Interpreter

Log Sources:
  - Wazuh process monitoring
  - Anomaly detection module
  - Behavioral analysis engine

Test Examples:
  - PowerShell execution from unusual parent process
  - System process running from non-standard location
  - Unexpected command line arguments
  - Process execution at unusual times

Tuning Notes:
  - Train baseline over at least 2-4 weeks
  - Adjust anomaly score threshold based on environment
  - Whitelist known process variations
  - Correlate with other security events
  - Review and update baselines regularly
  - Consider different baselines for different host types
  - Alert on score 8+ for production systems
-->
