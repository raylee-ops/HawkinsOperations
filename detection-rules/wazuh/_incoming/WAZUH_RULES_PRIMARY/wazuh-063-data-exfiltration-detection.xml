<!--
  Wazuh Rule: Potential Data Exfiltration Detected
  ID: 100063
  Level: 10 (High)
  Description: Detects large outbound data transfers indicating possible exfiltration
  Author: HawkinsOps SOC
  Date: 2025-11-18
-->

<group name="exfiltration,network,">
  <rule id="100063" level="10">
    <if_sid>5120</if_sid>
    <field name="bytes_out">^[5-9]\d{8,}$|^\d{9,}$</field>
    <description>Large outbound data transfer detected - Possible data exfiltration</description>
    <mitre>
      <id>T1041</id>
    </mitre>
    <group>data_exfiltration,network_transfer,</group>
  </rule>
</group>

<!--
Summary:
  Triggers on outbound network connections transferring 500MB+ data, which may indicate
  data theft or exfiltration attempts.

Fields Used:
  - bytes_out: Outbound data volume
  - dst_ip: Destination IP address
  - dst_port: Destination port
  - src_user: User account initiating transfer
  - protocol: Network protocol used

False Positives:
  - Legitimate cloud backups
  - File sharing services
  - Software updates and downloads
  - Database replication
  - Video conferencing and streaming

Severity: High (10)

MITRE ATT&CK: T1041 - Exfiltration Over C2 Channel

Log Sources:
  - Firewall logs with byte count
  - Network flow data (NetFlow, IPFIX)
  - Proxy logs
  - Network monitoring tools

Test Examples:
  - 2GB upload to unknown external IP
  - Large FTP transfer to suspicious destination
  - HTTP POST with massive data payload
  - Cloud storage upload of unusual size

Tuning Notes:
  - Adjust byte threshold based on normal business operations
  - Whitelist known backup destinations and cloud services
  - Monitor for transfers to unknown/new destinations
  - Correlate with file access events
  - Check for compression/archival before transfer
  - Alert on transfers during off-hours
  - Track destinations against threat intelligence
  - Implement DLP (Data Loss Prevention) solutions
-->
