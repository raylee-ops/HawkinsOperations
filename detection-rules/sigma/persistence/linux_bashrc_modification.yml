title: Linux Shell Profile Modification
id: 0d1e2f3a-4b5c-6d7e-8f9a-0b1c2d3e4f5a
status: stable
description: Detects modifications to shell profile files for persistence
references:
    - https://attack.mitre.org/techniques/T1546/004/
author: HawkinsOps SOC
date: 2025/01/15
modified: 2025/01/15
tags:
    - attack.persistence
    - attack.privilege_escalation
    - attack.t1546.004
logsource:
    product: linux
    service: auditd
detection:
    selection:
        type: 'PATH'
        name:
            - '/etc/profile'
            - '/etc/bash.bashrc'
            - '/etc/bashrc'
        name|endswith:
            - '/.bashrc'
            - '/.bash_profile'
            - '/.profile'
            - '/.zshrc'
    filter:
        exe|contains:
            - '/usr/bin/vi'
            - '/usr/bin/nano'
            - '/usr/bin/vim'
    condition: selection
falsepositives:
    - User customization
    - Legitimate administrative changes
    - Dotfile management tools
level: low
