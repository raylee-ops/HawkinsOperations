title: Kerberoasting Attack Detection
id: 6c3d7e8f-9a0b-1c2d-3e4f-5a6b7c8d9e0f
status: stable
description: Detects potential Kerberoasting attacks via RC4 ticket requests or suspicious TGS requests
references:
    - https://attack.mitre.org/techniques/T1558/003/
    - https://adsecurity.org/?p=2293
author: HawkinsOps SOC
date: 2025/01/15
modified: 2025/01/15
tags:
    - attack.credential_access
    - attack.t1558.003
logsource:
    product: windows
    service: security
detection:
    selection:
        EventID: 4769
        TicketEncryptionType: '0x17'
        ServiceName|endswith: '$'
    filter:
        ServiceName|startswith:
            - 'krbtgt'
            - '$@'
    filter_computer:
        ServiceName|endswith: '$'
    condition: selection and not 1 of filter_*
falsepositives:
    - Old systems and applications that don't support AES encryption
    - Some service accounts may legitimately request RC4 tickets
    - Legacy applications
level: medium
