title: PowerShell Credential Prompt
id: 1a2b3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d
status: stable
description: Detects PowerShell scripts attempting to capture credentials via prompt dialogs
references:
    - https://attack.mitre.org/techniques/T1056/002/
author: HawkinsOps SOC
date: 2025/01/15
modified: 2025/01/15
tags:
    - attack.credential_access
    - attack.t1056.002
    - attack.collection
logsource:
    product: windows
    service: powershell
    definition: 'Script Block Logging must be enabled'
detection:
    selection:
        EventID: 4104
        ScriptBlockText|contains:
            - 'Get-Credential'
            - 'PromptForCredential'
            - '$credential = '
            - 'ConvertTo-SecureString'
            - 'CredentialManager'
    condition: selection
falsepositives:
    - Legitimate administrative scripts
    - Password management tools
    - Automation scripts
level: medium
