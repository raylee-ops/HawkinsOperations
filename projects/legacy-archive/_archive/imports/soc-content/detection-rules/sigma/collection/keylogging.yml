title: Keylogging Activity Detection
id: 0e1f2a3b-4c5d-6e7f-8a9b-0c1d2e3f4a5b
status: experimental
description: Detects potential keylogging activity
references:
    - https://attack.mitre.org/techniques/T1056/001/
author: HawkinsOps SOC
date: 2025/01/15
modified: 2025/01/15
tags:
    - attack.collection
    - attack.credential_access
    - attack.t1056.001
logsource:
    product: windows
    service: powershell
    definition: 'Script Block Logging must be enabled'
detection:
    selection:
        EventID: 4104
        ScriptBlockText|contains:
            - 'GetAsyncKeyState'
            - 'SetWindowsHookEx'
            - 'GetForegroundWindow'
            - 'kernel32::GetAsyncKeyState'
    condition: selection
falsepositives:
    - Legitimate input monitoring tools
    - Accessibility software
level: high
