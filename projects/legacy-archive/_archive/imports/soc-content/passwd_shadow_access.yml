title: Linux Password File Access
id: 8e5f9a0b-1c2d-3e4f-5a6b-7c8d9e0f1a2b
status: stable
description: Detects suspicious access to /etc/passwd or /etc/shadow files on Linux systems
references:
    - https://attack.mitre.org/techniques/T1003/008/
author: HawkinsOps SOC
date: 2025/01/15
modified: 2025/01/15
tags:
    - attack.credential_access
    - attack.t1003.008
logsource:
    product: linux
    service: auditd
detection:
    selection:
        type: 'PATH'
        name:
            - '/etc/shadow'
            - '/etc/security/passwd'
            - '/etc/master.passwd'
    filter_legitimate:
        exe:
            - '/usr/sbin/sshd'
            - '/usr/bin/passwd'
            - '/usr/sbin/useradd'
            - '/usr/sbin/usermod'
            - '/usr/bin/sudo'
            - '/usr/sbin/chpasswd'
    condition: selection and not filter_legitimate
falsepositives:
    - System administration tools
    - User management utilities
    - Backup software
    - Configuration management tools (Ansible, Puppet, Chef)
level: high
