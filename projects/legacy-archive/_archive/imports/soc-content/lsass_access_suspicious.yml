title: Suspicious LSASS Process Access
id: 32d0d3e2-adf8-4cbe-9d6a-1d65f3f4f4e1
status: stable
description: Detects suspicious access to lsass.exe process memory which may indicate credential dumping attempts
references:
    - https://attack.mitre.org/techniques/T1003/001/
    - https://www.microsoft.com/security/blog/2022/10/05/detecting-and-preventing-lsass-credential-dumping-attacks/
author: HawkinsOps SOC
date: 2025/01/15
modified: 2025/01/15
tags:
    - attack.credential_access
    - attack.t1003.001
    - attack.t1003
logsource:
    product: windows
    category: process_access
    service: sysmon
detection:
    selection:
        EventID: 10
        TargetImage|endswith: '\lsass.exe'
        GrantedAccess|contains:
            - '0x1410'
            - '0x1010'
            - '0x1438'
            - '0x143a'
            - '0x1418'
            - '0x1f0fff'
            - '0x1f1fff'
            - '0x1f2fff'
            - '0x1f3fff'
    filter_known_good:
        SourceImage|endswith:
            - '\wmiprvse.exe'
            - '\taskmgr.exe'
            - '\procexp64.exe'
            - '\procexp.exe'
            - '\MsMpEng.exe'
            - '\Microsoft.Identity.AadConnect.Health.AadSync.Host.exe'
    filter_defender:
        SourceImage|startswith: 'C:\ProgramData\Microsoft\Windows Defender\'
    filter_programfiles:
        SourceImage|startswith:
            - 'C:\Program Files\'
            - 'C:\Program Files (x86)\'
        SourceImage|contains:
            - '\Citrix\'
            - '\Microsoft\\'
    condition: selection and not 1 of filter_*
falsepositives:
    - Legitimate security tools and EDR solutions
    - System monitoring tools
    - Backup software
level: high
